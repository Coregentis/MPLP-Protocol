# MPLP测试方法论应用检查清单

## 📋 **模块测试完整检查清单**

### **阶段1: 准备阶段**

#### **信息收集 (必须完成)**
- [ ] 使用`codebase-retrieval`深入分析目标模块的完整实现
- [ ] 查看所有公共方法和接口定义
- [ ] 理解核心业务逻辑和数据流
- [ ] 分析依赖关系和集成点
- [ ] 确认类型定义和Schema规范
- [ ] 了解错误处理机制

#### **用户需求分析 (必须完成)**
- [ ] 识别主要用户角色（管理员、开发者、最终用户等）
- [ ] 分析每个角色的日常使用场景
- [ ] 理解用户的痛点和期望
- [ ] 确定关键业务流程
- [ ] 识别边界条件和异常情况

#### **测试策略制定**
- [ ] 确定功能场景覆盖范围（目标90%+）
- [ ] 规划测试用例结构
- [ ] 设计Mock策略
- [ ] 确定验证标准

### **阶段2: 测试实施阶段**

#### **测试文件创建**
- [ ] 创建功能场景测试文件 `tests/functional/[module]-functional.test.ts`
- [ ] 添加完整的文件头注释（目的、用户场景、版本等）
- [ ] 设置正确的导入和依赖
- [ ] 配置Mock对象和测试环境

#### **功能场景测试编写**
- [ ] **场景1**: 基本功能场景（用户最常见需求）
  - [ ] 至少3个测试用例
  - [ ] 基于真实用户场景描述
  - [ ] 验证核心功能正确性
- [ ] **场景2**: 高级功能场景（专业用户需求）
  - [ ] 至少2个测试用例
  - [ ] 覆盖复杂业务逻辑
  - [ ] 验证高级功能特性
- [ ] **场景3**: 异常处理场景（系统健壮性）
  - [ ] 至少2个测试用例
  - [ ] 覆盖错误处理逻辑
  - [ ] 验证异常情况处理
- [ ] **场景4**: 边界条件场景（极端情况）
  - [ ] 至少2个测试用例
  - [ ] 测试输入验证
  - [ ] 验证边界值处理
- [ ] **场景5**: 查询和管理场景（信息检索）
  - [ ] 至少2个测试用例
  - [ ] 验证查询功能
  - [ ] 测试数据管理操作

#### **测试质量验证**
- [ ] 所有测试用例都有明确的用户场景描述
- [ ] 测试数据基于实际需求设计
- [ ] Mock对象配置正确且合理
- [ ] 断言验证用户期望的结果
- [ ] 错误处理测试覆盖完整

### **阶段3: 问题发现和修复阶段**

#### **测试执行和问题识别**
- [ ] 运行功能场景测试：`npm test -- --testPathPattern="[module]-functional.test.ts" --verbose`
- [ ] 记录所有测试失败情况
- [ ] 分析失败原因：源代码问题 vs 测试问题
- [ ] 对每个失败进行分类：
  - [ ] 功能缺失
  - [ ] 类型定义缺失
  - [ ] 业务逻辑错误
  - [ ] API接口不匹配
  - [ ] 验证逻辑缺失

#### **源代码问题修复**
- [ ] **功能缺失修复**
  - [ ] 在源代码中添加缺失的功能
  - [ ] 确保实现符合用户需求
  - [ ] 添加必要的验证逻辑
- [ ] **类型定义修复**
  - [ ] 添加缺失的类型字段
  - [ ] 确保类型安全性
  - [ ] 更新相关接口定义
- [ ] **业务逻辑修复**
  - [ ] 修复逻辑错误
  - [ ] 确保业务规则正确
  - [ ] 保持向后兼容性
- [ ] **API接口修复**
  - [ ] 统一接口设计
  - [ ] 确保参数格式一致
  - [ ] 更新文档说明

#### **系统性影响分析**
- [ ] 分析修复对其他模块的影响
- [ ] 识别相同问题模式
- [ ] 执行系统性修复（如适用）
- [ ] 更新相关文档和注释

### **阶段4: 验证阶段**

#### **链式验证执行**
- [ ] **TypeScript编译验证**
  - [ ] 运行：`npm run typecheck`
  - [ ] 确保零编译错误
  - [ ] 解决所有类型问题
- [ ] **功能场景测试验证**
  - [ ] 重新运行功能场景测试
  - [ ] 确保所有测试通过
  - [ ] 验证修复有效性
- [ ] **单元测试验证**
  - [ ] 运行相关单元测试
  - [ ] 确保现有功能不受影响
  - [ ] 验证向后兼容性
- [ ] **集成测试验证**（如适用）
  - [ ] 运行集成测试
  - [ ] 验证模块间协作
  - [ ] 确保系统整体稳定
- [ ] **端到端测试验证**
  - [ ] 运行E2E测试
  - [ ] 验证完整业务流程
  - [ ] 确保用户体验正常

#### **质量保证检查**
- [ ] 功能场景覆盖率 ≥ 90%
- [ ] 所有测试用例通过率 = 100%
- [ ] TypeScript编译错误 = 0
- [ ] 源代码问题修复率 = 100%
- [ ] 系统稳定性验证通过

### **阶段5: 文档和总结阶段**

#### **文档更新**
- [ ] 更新4层测试策略文档
- [ ] 记录发现的问题和修复方案
- [ ] 更新模块测试状态
- [ ] 添加成就总结

#### **经验总结**
- [ ] 记录测试过程中的发现
- [ ] 总结有效的测试模式
- [ ] 识别可改进的地方
- [ ] 分享最佳实践

## 🎯 **质量门禁标准**

### **必须达到的标准**
- [ ] 功能场景覆盖率 > 90%
- [ ] 测试用例通过率 = 100%
- [ ] TypeScript编译错误 = 0
- [ ] 所有发现的源代码问题已修复
- [ ] 链式验证全部通过
- [ ] 文档同步更新完成

### **可选的增强标准**
- [ ] 性能测试通过
- [ ] 安全性检查通过
- [ ] 可访问性验证通过
- [ ] 代码覆盖率 > 95%

## 🚨 **常见陷阱检查**

### **避免的错误做法**
- [ ] ❌ 没有修改测试期望来适应错误的实现
- [ ] ❌ 没有跳过失败的测试用例
- [ ] ❌ 没有使用过度的mock导致测试失去意义
- [ ] ❌ 没有为了提高通过率而降低测试标准
- [ ] ❌ 没有忽略源代码问题，只关注测试通过
- [ ] ❌ 没有脱离实际需求编写测试
- [ ] ❌ 没有忽视系统性影响

### **确保的正确做法**
- [ ] ✅ 基于真实用户场景设计测试
- [ ] ✅ 基于实际实现编写测试
- [ ] ✅ 发现问题时优先修复源代码
- [ ] ✅ 执行完整的链式验证
- [ ] ✅ 保持系统整体稳定性
- [ ] ✅ 记录和分享经验教训

## 📊 **进度跟踪**

### **模块测试进度**
- [ ] Context模块 ✅
- [ ] Plan模块 ✅
- [ ] Confirm模块 ✅
- [ ] Trace模块 ✅
- [ ] Role模块 ✅
- [ ] Extension模块 ✅
- [ ] Collab模块 ✅
- [ ] Dialog模块 ✅
- [ ] Network模块 ✅

### **总体统计**
- 完成模块数: ___/9
- 总测试用例数: ___
- 发现问题数: ___
- 修复问题数: ___
- 质量门禁通过: ___

---

**使用说明**: 
1. 为每个模块复制此检查清单
2. 按阶段逐项完成检查
3. 确保所有必须项都已完成
4. 记录进度和发现的问题
5. 在完成后进行经验总结

**记住**: 这个检查清单是确保测试质量和方法论正确应用的重要工具！
